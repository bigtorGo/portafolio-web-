<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles/style.css">
  <link rel="stylesheet" href="/styles/tailwind.css">
  <script type="text/javascript" src="/emailValidation.js" defer></script>
  <title>Contact</title>
</head>

<body>
  <div name="alert"
    class="animate-stop animate-fade-down animate-duration-500 animate-ease-out flex justify-evenly w-[500px] mx-auto my-2 px-4 py-4 text-base text-white  rounded-lg font-regular">
    <div class="shrink-0">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
        class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z">
        </path>
      </svg>
    </div>
    <div class="ml-3 mr-12"> <span>eSTO EXISTE?</span></div>
  </div>

  <div
    class="relative my-5 m-auto max-w-lg min-w-min flex flex-col items-center text-gray-700 bg-transparent shadow-lg rounded-xl bg-clip-border">
    <h4 class="block font-sans text-2xl antialiased font-semibold leading-snug tracking-wide text-blue-gray-900">
      Contacto
    </h4>
    <p class="block mt-1 font-sans text-base antialiased font-normal leading-relaxed text-gray-700">
      Escribeme, estaré encantado de conocerte.
    </p>
    <form id="contactForm" class="max-w-screen-md mt-8 mb-2 w-80 sm:w-96">
      <div class="flex flex-col gap-5 lg:gap-7 mb-1">
        <!-- <h6
              class="block -mb-3 font-sans text-base antialiased font-semibold leading-relaxed tracking-normal text-blue-gray-900">
             
            </h6>-->

        <div class="relative h-11 w-full min-w-min">
          <input id="nameInput" name="name"
            class="peer w-full h-full bg-transparent text-blue-gray-700 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-blue-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 border focus:border-2  text-sm px-7 py-2.5 rounded-[7px] border-blue-gray-200 focus:border-green-700"
            placeholder="" />
          <!--      class="flex w-full h-full select-none pointer-events-none absolute left-0 font-normal 
            !overflow-visible truncate peer-placeholder-shown:text-blue-gray-500 leading-tight peer-focus:leading-tight 
            peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-gray-500 transition-all -top-1.5 
            peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] 
            before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 
            peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-2 
            before:border-l peer-focus:before:border-l-2 before:pointer-events-none before:transition-all 
            eer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 
            after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md 
            after:border-t peer-focus:after:border-t-2 after:border-r peer-focus:after:border-r-2 after:pointer-events-none 
            after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] 
            text-gray-500 peer-focus:text-gray-900 before:border-blue-gray-200 peer-focus:before:!border-gray-900 
            after:border-blue-gray-200 peer-focus:after:!border-gray-900">Username -->
          <label class="select-none pointer-events-none absolute left-3 font-normal  truncate 
            peer-placeholder-shown:text-blue-gray-500 leading-tight peer-focus:leading-tight  transition-all 
            text-[11px]  bg-white peer-placeholder-shown:text-[14px]
            peer-focus:text-[11px]   px-1.5  text-gray-500 
            peer-placeholder-shown:top-3 -top-2 peer-focus:-top-2
            peer-focus:text-green-700">Nombre</label><!-- El place holder tiene un espacio pero activa el place holder shown. 
            Es decir que todo lo que use esa pseudo clase se ejecutara cuando "no hay contenido" en el input-->
          <span class="hidden text-xs lg:text-sm text-red-600 bottom-1 pb-4  px-3"></span>
        </div>
        <div class="relative h-11 w-full min-w-min">
          <input id="organizationInput" name="organization"
            class="peer w-full h-full bg-transparent text-blue-gray-700 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-blue-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 border focus:border-2  text-sm px-7 py-2.5 rounded-[7px] border-blue-gray-200 focus:border-green-700"
            placeholder=" " />
          <label class="select-none pointer-events-none absolute left-3 font-normal  truncate 
            peer-placeholder-shown:text-blue-gray-500 leading-tight peer-focus:leading-tight  transition-all 
            text-[11px]  bg-white peer-placeholder-shown:text-[14px]
            peer-focus:text-[11px]   px-1.5  text-gray-500 
            peer-placeholder-shown:top-3 -top-2 peer-focus:-top-2
            peer-focus:text-green-700">organización(opcional)
          </label>

        </div>

        <div class="relative h-11 w-full min-w-min ">
          <input type="email" id="emailInput" maxlength="50" name="email"
            class="peer w-full h-full bg-transparent text-blue-gray-700 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-blue-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 border focus:border-2  text-sm px-3 py-2.5 rounded-[7px] border-blue-gray-200 focus:border-green-700"
            placeholder=" " />
          <label for="emailInput" class="select-none pointer-events-none absolute left-3 font-normal  truncate 
            peer-placeholder-shown:text-blue-gray-500 leading-tight peer-focus:leading-tight  transition-all 
            text-[11px]  bg-white peer-placeholder-shown:text-[14px]
            peer-focus:text-[11px]   px-1.5  text-gray-500 
            peer-placeholder-shown:top-3 -top-2 peer-focus:-top-2
            peer-focus:text-green-700">Email
          </label>
          <span class="hidden text-xs lg:text-sm text-red-600 bottom-1 pb-4  px-3"></span>
        </div>
        <div class="relative mt-4 h-20 lg:h-40 w-full min-w-min ">

          <textarea id="messageInput" maxlength="150" placeholder="" name="message" class="peer resize-none w-full h-full bg-transparent text-blue-gray-700 font-sans font-normal outline outline-0 
            focus:outline-0 disabled:bg-blue-gray-50 disabled:border-0 transition-all placeholder-shown:border 
            placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 border focus:border-2  text-sm px-3 py-2.5 
            rounded-[7px] border-blue-gray-200 focus:border-green-700"></textarea>

          <label for="messageInput" class="select-none pointer-events-none absolute left-3 font-normal  truncate 
            peer-placeholder-shown:text-blue-gray-500 leading-tight peer-focus:leading-tight  transition-all 
            text-[11px]  peer-placeholder-shown:text-[14px]
            peer-focus:text-[11px]   px-1.5  text-gray-500 
            peer-placeholder-shown:top-3 -top-2 peer-focus:-top-2 bg-white
            peer-focus:text-green-700">Mensaje
          </label>
          <span class="hidden text-xs lg:text-sm text-red-600 bottom-1 pb-4  px-3"></span>
        </div>

      </div>
      <div class="inline-flex items-center">

      </div>
      <button onclick="sendData()" type="button" id="submitBtn" class="mt-3 lg:mt-5 block w-full select-none rounded-lg bg-gray-900 py-3 px-6 
            text-center align-middle font-sans text-xs font-bold uppercase text-white 
            shadow-md shadow-gray-900/10 transition-all 
            hover:shadow-lg hover:shadow-gray-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85]
             active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none">
        Enviar
      </button>

    </form>
  </div>
</body>

</html>

<script>



  async function sendData() {

    const email = document.getElementById('emailInput').value;
    const name = document.getElementById('nameInput').value;
    const organization = document.getElementById('organizationInput').value;
    const message = document.getElementById('messageInput').value;
    //bloquear el boton enviar y poner una animación de carga en este
    try {
      const res = await fetch('/send-email', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          name,
          email,
          message,
          organization,
        })
      })

      console.log(res)
      const alert = document.querySelector(".animate-stop");
      const parrf= document.querySelector(".animate-stop div span");
      if (res.status == 202) 
      {
        
        console.log(alert);
        console.log(parrf);
        alert.classList.remove("animate-stop");
        
        parrf.innerText=`Email enviado. Gracias por escribirme${String.fromCodePoint(0x1F601)}.`
        //para los emojis usar https://unicode.org/emoji/charts/full-emoji-list.html#1f601 y remplazar U+ por 0x
        alert.classList.add("bg-green-500"); 
        //alert.classList.add("animate-play");
        setTimeout(() => {
          //window.location.replace("/");
        }, 2600)
        //mostrar la barra de notificacion con el mensaje de exito.
        //redirigir a la página principal.

      }
     /* if(res.status>=400){
        alert.innerText="Hubo un problema con el servicio de email. Puedes intentarlo más tarde."
        alert.classList.add("bg-yellow-300");
        alert.classList.remove("animate-stop");
      }*/

    }
    catch (error) {
      console.log('ERROR', error)
    }



    //debloquear boton



  }


</script>